<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">CV Professionnel</title>
    <meta name="description" content="CV Professionnel configurable par JSON">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
        }

        /* Animations */
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        section {
            animation: slideInLeft 0.6s ease-out;
            animation-fill-mode: both;
        }

        section:nth-child(1) {
            animation-delay: 0.1s;
        }

        section:nth-child(2) {
            animation-delay: 0.2s;
        }

        section:nth-child(3) {
            animation-delay: 0.3s;
        }

        section:nth-child(4) {
            animation-delay: 0.4s;
        }

        .experience-item {
            animation: fadeIn 0.5s ease-out;
            animation-fill-mode: both;
        }

        .experience-item:nth-child(1) {
            animation-delay: 0.3s;
        }

        .experience-item:nth-child(2) {
            animation-delay: 0.4s;
        }

        .experience-item:nth-child(3) {
            animation-delay: 0.5s;
        }

        /* Focus states */
        a:focus,
        button:focus {
            outline: 3px solid #818cf8;
            outline-offset: 2px;
        }

        /* Progress bars */
        .skill-bar {
            transition: width 1s ease-out;
            box-shadow: 0 1px 3px rgba(99, 102, 241, 0.3);
        }

        /* Timeline */
        .timeline-line {
            background: linear-gradient(180deg, #a78bfa 0%, #c4b5fd 50%, #ddd6fe 100%);
        }

        /* Headers */
        .section-header {
            font-weight: 800;
            letter-spacing: 0.05em;
        }

        /* Cards */
        .project-card {
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .project-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.15);
        }

        @media print {
            .no-print {
                display: none !important;
            }

            body {
                background-color: white;
            }

            .max-w-7xl {
                margin: 0;
                max-width: 100%;
                padding: 0;
            }

            .shadow-2xl {
                box-shadow: none;
            }

            .rounded-3xl {
                border-radius: 0;
            }

            section {
                page-break-inside: avoid;
                break-inside: avoid;
            }

            .experience-item {
                page-break-inside: avoid;
                break-inside: avoid;
            }

            .project-card {
                page-break-inside: avoid;
                break-inside: avoid;
            }

            * {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            @page {
                margin: 0.5cm;
                size: A4;
            }
        }

        @media (max-width: 768px) {
            aside {
                position: relative;
            }

            .w-32.h-32 {
                width: 100px;
                height: 100px;
            }
        }
    </style>
</head>

<body class="text-slate-800 antialiased">

    <!-- Bouton Import JSON -->
    <div class="max-w-7xl mx-auto mt-8 mb-4 text-center no-print">
        <input type="file" id="jsonFileInput" accept=".json" class="hidden">
        <button onclick="document.getElementById('jsonFileInput').click()"
            class="bg-slate-700 hover:bg-slate-800 text-white font-bold py-3 px-8 rounded-full shadow-lg transition-all transform hover:scale-105 flex items-center gap-3 mx-auto">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
            </svg>
            <span>IMPORTER UN JSON</span>
        </button>
    </div>

    <div id="cv-content"
        class="max-w-7xl mx-auto my-8 bg-white shadow-2xl rounded-3xl overflow-hidden flex flex-col md:flex-row">

        <!-- Sidebar Gauche -->
        <aside class="w-full md:w-[280px] bg-slate-900 text-white p-6 flex flex-col flex-shrink-0">
            <!-- Avatar -->
            <div class="flex flex-col items-center text-center mb-6">
                <div id="avatar-container"
                    class="w-32 h-32 rounded-full border-4 border-indigo-500 p-1 mb-4 overflow-hidden bg-slate-800 flex items-center justify-center shadow-lg shadow-indigo-500/50">
                    <div
                        class="w-full h-full rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-4xl font-bold">
                        ?
                    </div>
                </div>
                <h1 id="nom" class="text-2xl font-bold tracking-tight">Nom Pr√©nom</h1>
                <p id="titre"
                    class="text-indigo-400 font-semibold mt-1 text-xs uppercase tracking-widest leading-tight">Titre</p>
            </div>

            <!-- Contact -->
            <div class="space-y-3 mb-6 text-xs">
                <h3
                    class="text-indigo-300 font-bold uppercase text-[10px] tracking-widest border-b-2 border-indigo-700 pb-2">
                    Contact</h3>
                <div id="contact-container"></div>
            </div>

            <!-- Comp√©tences principales -->
            <div id="competences-principales-section" class="space-y-4 mb-6">
                <h3 id="competences-principales-titre"
                    class="text-indigo-300 font-bold uppercase text-[10px] tracking-widest border-b-2 border-indigo-700 pb-2">
                    Comp√©tences</h3>
                <div id="competences-principales-container" class="space-y-2.5 text-xs"></div>
            </div>

            <!-- Comp√©tences secondaires -->
            <div id="competences-secondaires-section" class="space-y-3 mb-6">
                <h3 id="competences-secondaires-titre"
                    class="text-indigo-300 font-bold uppercase text-[10px] tracking-widest border-b-2 border-indigo-700 pb-2">
                    Comp√©tences</h3>
                <div id="competences-secondaires-container" class="flex flex-wrap gap-1.5"></div>
            </div>

            <!-- Autres sections sidebar -->
            <div id="autres-sections-sidebar"></div>

            <!-- Langues -->
            <div class="space-y-2.5">
                <h3
                    class="text-indigo-300 font-bold uppercase text-[10px] tracking-widest border-b-2 border-indigo-700 pb-2">
                    Langues</h3>
                <div id="langues-container" class="space-y-2 text-xs"></div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-8 bg-white">

            <!-- PROFIL -->
            <section class="mb-8">
                <h2
                    class="section-header text-xl font-bold mb-3 flex items-center gap-2 uppercase tracking-widest text-slate-900">
                    <span class="w-8 h-0.5 bg-indigo-600 rounded-full"></span>
                    Profil
                </h2>
                <p id="profil-description"
                    class="text-slate-700 leading-relaxed text-sm border-l-4 border-indigo-100 pl-4 font-medium"></p>
            </section>

            <!-- EXP√âRIENCES -->
            <section class="mb-8">
                <h2
                    class="section-header text-xl font-bold mb-5 flex items-center gap-2 uppercase tracking-widest text-slate-900">
                    <span class="w-8 h-0.5 bg-purple-600 rounded-full"></span>
                    Exp√©riences Professionnelles
                </h2>
                <div id="experiences-container" class="space-y-6"></div>
            </section>

            <!-- FORMATION & CERTIFICATIONS -->
            <section class="mb-8">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div>
                        <h2
                            class="section-header text-xl font-bold mb-4 flex items-center gap-2 uppercase tracking-widest">
                            <span class="w-6 h-0.5 bg-indigo-600 rounded-full"></span>
                            Formation
                        </h2>
                        <div id="formations-container" class="space-y-3"></div>
                    </div>
                    <div>
                        <h2
                            class="section-header text-xl font-bold mb-4 flex items-center gap-2 uppercase tracking-widest">
                            <span class="w-6 h-0.5 bg-purple-600 rounded-full"></span>
                            Certifications
                        </h2>
                        <div id="certifications-container" class="space-y-2.5"></div>
                    </div>
                </div>
            </section>

            <!-- Sections suppl√©mentaires -->
            <div id="sections-supplementaires"></div>

        </main>
    </div>

    <!-- Bouton PDF -->
    <div class="max-w-7xl mx-auto mb-8 text-center no-print">
        <button onclick="downloadPDF()"
            class="bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-bold py-4 px-10 rounded-full shadow-2xl transition-all transform hover:scale-105 flex items-center gap-3 mx-auto focus:ring-4 focus:ring-indigo-300 border-2 border-indigo-400">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z">
                </path>
            </svg>
            <span class="text-base">T√âL√âCHARGER LE CV EN PDF</span>
        </button>
        <p class="text-slate-500 text-xs mt-4 font-medium">CV mis √† jour en D√©cembre 2025</p>
    </div>

    <script>
        // Donn√©es par d√©faut (peuvent √™tre √©cras√©es par import JSON)
        let cvData = null;

        // Fonction pour charger les donn√©es depuis un JSON
        function loadFromJSON(jsonData) {
            cvData = jsonData;
            renderCV();
        }

        // Fonction principale de rendu du CV
        function renderCV() {
            if (!cvData) return;

            // Titre de la page
            document.getElementById('page-title').textContent = `${cvData.identite.nom} - ${cvData.identite.titre_vise} | CV`;

            // Identit√©
            document.getElementById('nom').textContent = cvData.identite.nom;
            document.getElementById('titre').innerHTML = cvData.identite.titre_vise.replace(/&/g, '&<br>');

            // Avatar
            const avatarContainer = document.getElementById('avatar-container');
            if (cvData.identite.photo_url) {
                avatarContainer.innerHTML = `<img src="${cvData.identite.photo_url}" alt="Photo de ${cvData.identite.nom}" class="w-full h-full object-cover rounded-full">`;
            } else {
                const initiales = cvData.identite.nom.split(' ').map(n => n[0]).join('');
                avatarContainer.innerHTML = `<div class="w-full h-full rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-4xl font-bold">${initiales}</div>`;
            }

            // Contact
            renderContact();

            // Comp√©tences principales
            renderCompetencesPrincipales();

            // Comp√©tences secondaires
            renderCompetencesSecondaires();

            // Autres sections sidebar
            renderAutresSectionsSidebar();

            // Langues
            renderLangues();

            // Profil
            document.getElementById('profil-description').textContent = cvData.resume_executif;

            // Exp√©riences
            renderExperiences();

            // Formations
            renderFormations();

            // Certifications
            renderCertifications();

            // Sections suppl√©mentaires
            renderSectionsSupplementaires();
        }

        function renderContact() {
            const container = document.getElementById('contact-container');
            const contact = cvData.identite.contact;
            let html = '';

            if (contact.email) {
                html += `
                    <a href="mailto:${contact.email}" class="flex items-center gap-2 hover:text-indigo-300 transition-colors group">
                        <div class="text-indigo-400 group-hover:scale-110 transition-transform flex-shrink-0">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                        <span class="text-slate-100 group-hover:underline truncate">${contact.email}</span>
                    </a>
                `;
            }

            if (contact.telephone) {
                const telClean = contact.telephone.replace(/[^0-9+]/g, '');
                html += `
                    <a href="tel:${telClean}" class="flex items-center gap-2 hover:text-indigo-300 transition-colors group">
                        <div class="text-indigo-400 group-hover:scale-110 transition-transform flex-shrink-0">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                            </svg>
                        </div>
                        <span class="text-slate-100 group-hover:underline">${contact.telephone}</span>
                    </a>
                `;
            }

            if (contact.linkedin) {
                const linkedinUrl = contact.linkedin.startsWith('http') ? contact.linkedin : `https://${contact.linkedin}`;
                const linkedinDisplay = contact.linkedin.replace(/^(https?:\/\/)?(www\.)?/, '');
                html += `
                    <a href="${linkedinUrl}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 hover:text-indigo-300 transition-colors group">
                        <div class="text-indigo-400 group-hover:scale-110 transition-transform flex-shrink-0">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                            </svg>
                        </div>
                        <span class="text-slate-100 group-hover:underline truncate text-[11px]">${linkedinDisplay}</span>
                    </a>
                `;
            }

            if (cvData.identite.localisation) {
                html += `
                    <div class="flex items-center gap-2">
                        <div class="text-indigo-400 flex-shrink-0">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                        </div>
                        <span class="text-slate-100">${cvData.identite.localisation}</span>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        function renderCompetencesPrincipales() {
            if (!cvData.competences_principales) {
                document.getElementById('competences-principales-section').style.display = 'none';
                return;
            }

            const titre = document.getElementById('competences-principales-titre');
            const container = document.getElementById('competences-principales-container');

            titre.textContent = cvData.competences_principales.titre || 'Comp√©tences';

            let html = '';
            cvData.competences_principales.items.forEach(item => {
                html += `
                    <div>
                        <div class="flex justify-between mb-1.5">
                            <span class="text-slate-100 font-medium">${item.nom}</span>
                            <span class="text-[10px] text-indigo-300 font-semibold">${item.niveau}</span>
                        </div>
                        <div class="w-full bg-slate-700 rounded-full h-2">
                            <div class="skill-bar bg-gradient-to-r from-indigo-500 to-indigo-400 h-2 rounded-full" style="width: ${item.pourcentage}%"></div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function renderCompetencesSecondaires() {
            if (!cvData.competences_secondaires) {
                document.getElementById('competences-secondaires-section').style.display = 'none';
                return;
            }

            const titre = document.getElementById('competences-secondaires-titre');
            const container = document.getElementById('competences-secondaires-container');

            titre.textContent = cvData.competences_secondaires.titre || 'Comp√©tences';

            let html = '';
            cvData.competences_secondaires.items.forEach(item => {
                html += `<span class="px-2 py-1 bg-indigo-500/30 text-indigo-200 text-[10px] rounded-md border border-indigo-400/50 font-medium">${item}</span>`;
            });

            container.innerHTML = html;
        }

        function renderAutresSectionsSidebar() {
            if (!cvData.autres_sections_sidebar) return;

            const container = document.getElementById('autres-sections-sidebar');
            let html = '';

            cvData.autres_sections_sidebar.forEach(section => {
                html += `
                    <div class="space-y-3 mb-6">
                        <h3 class="text-indigo-300 font-bold uppercase text-[10px] tracking-widest border-b-2 border-indigo-700 pb-2">${section.titre}</h3>
                        <ul class="text-xs text-slate-100 space-y-1.5">
                            ${section.items.map(item => `<li class="flex items-center gap-2"><span class="text-indigo-400 text-sm">‚Ä¢</span> ${item}</li>`).join('')}
                        </ul>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function renderLangues() {
            const container = document.getElementById('langues-container');
            let html = '';

            Object.entries(cvData.langues).forEach(([langue, niveau]) => {
                const langueCap = langue.charAt(0).toUpperCase() + langue.slice(1);
                const niveauCourt = niveau.split(' ')[0]; // Prend juste "Natif" ou "B2" etc.
                html += `
                    <div class="flex justify-between items-center">
                        <span class="text-slate-100 font-medium">${langueCap}</span>
                        <span class="text-[9px] bg-indigo-600 text-white px-2 py-1 rounded uppercase font-semibold">${niveauCourt}</span>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function renderExperiences() {
            const container = document.getElementById('experiences-container');
            const colors = ['indigo-600', 'purple-500', 'purple-400', 'pink-500', 'blue-500'];
            let html = '';

            cvData.experiences_professionnelles.forEach((exp, index) => {
                const color = colors[index % colors.length];
                html += `
                    <div class="experience-item relative pl-6 pr-4 py-4 border-l-[3px] timeline-line group bg-purple-50/30 rounded-r-xl">
                        <div class="absolute -left-[9px] top-4 w-4 h-4 rounded-full bg-white border-[3px] border-${color} shadow-lg shadow-${color}/50 transition-transform group-hover:scale-125"></div>
                        <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-1.5">
                            <h4 class="text-base font-extrabold text-slate-900">${exp.poste}</h4>
                            <span class="text-indigo-700 font-bold bg-indigo-100 px-2.5 py-1 rounded-lg text-xs shadow-sm">${exp.periode}</span>
                        </div>
                        <p class="text-purple-600 font-bold mb-2 text-sm">${exp.entreprise}</p>
                        <ul class="text-slate-700 space-y-1.5 list-disc list-inside text-xs leading-relaxed">
                            ${exp.realisations.map(real => `<li>${real}</li>`).join('')}
                        </ul>
                        ${exp.clients_cles ? `
                            <div class="mt-2 flex flex-wrap gap-1">
                                ${exp.clients_cles.map(client => `<span class="text-[9px] bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full font-semibold">${client}</span>`).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function renderFormations() {
            const container = document.getElementById('formations-container');
            let html = '';

            cvData.formations_certifications.filter(f => f.type === 'formation').forEach(formation => {
                html += `
                    <div class="p-3 bg-slate-50 rounded-lg border-l-4 border-indigo-600 shadow-sm">
                        <span class="text-[10px] font-bold text-indigo-700">${formation.date}</span>
                        <h4 class="font-bold text-slate-900 text-sm">${formation.titre}</h4>
                        <p class="text-[10px] text-slate-600 font-medium">${formation.organisme}</p>
                        ${formation.details ? `<p class="text-[10px] text-slate-700 mt-1">${formation.details}</p>` : ''}
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function renderCertifications() {
            const container = document.getElementById('certifications-container');
            let html = '';

            cvData.formations_certifications.filter(f => f.type === 'certification').forEach(cert => {
                html += `
                    <div class="flex items-center gap-3 p-2.5 border border-slate-200 rounded-lg bg-white shadow-sm hover:shadow-md transition-shadow">
                        <div class="bg-purple-100 p-1.5 rounded text-purple-600 flex-shrink-0">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                            </svg>
                        </div>
                        <div>
                            <h5 class="font-bold text-xs text-slate-900">${cert.titre}</h5>
                            <p class="text-[10px] text-slate-600">${cert.organisme} ‚Ä¢ ${cert.date}${cert.details ? ' ‚Ä¢ ' + cert.details : ''}</p>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function renderSectionsSupplementaires() {
            if (!cvData.sections_supplementaires) return;

            const container = document.getElementById('sections-supplementaires');
            let html = '';

            cvData.sections_supplementaires.forEach(section => {
                html += `
                    <section class="mb-8">
                        <h2 class="section-header text-xl font-bold mb-4 flex items-center gap-2 uppercase tracking-widest text-slate-900">
                            <span class="w-8 h-0.5 bg-${section.couleur || 'indigo'}-600 rounded-full"></span>
                            ${section.titre}
                        </h2>
                `;

                if (section.type === 'cards') {
                    html += `<div class="grid grid-cols-1 md:grid-cols-${section.colonnes || 3} gap-4">`;
                    section.items.forEach(item => {
                        html += `
                            <div class="project-card p-4 bg-gradient-to-br from-${item.couleur || 'indigo'}-50 to-${item.couleur || 'purple'}-50 rounded-xl border-2 border-${item.couleur || 'indigo'}-200">
                                ${item.emoji ? `
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="text-2xl">${item.emoji}</span>
                                        <h5 class="font-extrabold text-sm text-slate-900">${item.titre}</h5>
                                    </div>
                                ` : `<h5 class="font-extrabold text-sm text-slate-900 mb-2">${item.titre}</h5>`}
                                ${item.description ? `<p class="text-xs text-slate-700 mb-2 leading-relaxed">${item.description}</p>` : ''}
                                ${item.tags ? `
                                    <div class="flex flex-wrap gap-1">
                                        ${item.tags.map(tag => `<span class="text-[9px] bg-white px-2 py-1 rounded-full text-${item.couleur || 'indigo'}-700 border-2 border-${item.couleur || 'indigo'}-300 font-bold">${tag}</span>`).join('')}
                                    </div>
                                ` : ''}
                            </div>
                        `;
                    });
                    html += `</div>`;
                } else if (section.type === 'grid') {
                    html += `<div class="grid grid-cols-2 md:grid-cols-${section.colonnes || 4} gap-3">`;
                    section.items.forEach(item => {
                        html += `
                            <div class="group bg-slate-50 p-3 rounded-xl hover:bg-indigo-600 transition-all duration-300 cursor-default border-2 border-transparent hover:border-indigo-400 text-center">
                                ${item.emoji ? `<span class="text-2xl mb-2 block group-hover:scale-110 transition-transform">${item.emoji}</span>` : ''}
                                <h5 class="font-bold text-xs text-slate-900 group-hover:text-white transition-colors">${item.titre}</h5>
                                ${item.description ? `<p class="text-[10px] text-slate-600 group-hover:text-indigo-100 transition-colors">${item.description}</p>` : ''}
                            </div>
                        `;
                    });
                    html += `</div>`;
                }

                html += `</section>`;
            });

            container.innerHTML = html;
        }

        // Gestion de l'import de fichier JSON
        document.getElementById('jsonFileInput').addEventListener('change', function (e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function (event) {
                try {
                    const jsonData = JSON.parse(event.target.result);
                    loadFromJSON(jsonData);
                    alert('‚úÖ CV charg√© avec succ√®s !');
                } catch (error) {
                    alert('‚ùå Erreur lors du chargement du JSON : ' + error.message);
                }
            };
            reader.readAsText(file);
        });

        // Fonction de t√©l√©chargement PDF
        function downloadPDF() {
            const element = document.getElementById('cv-content');
            const nom = cvData ? cvData.identite.nom.replace(/\s+/g, '_') : 'CV';

            const opt = {
                margin: [3, 3, 3, 3],
                filename: `CV_${nom}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: {
                    scale: 2,
                    useCORS: true,
                    letterRendering: true
                },
                jsPDF: {
                    unit: 'mm',
                    format: 'a4',
                    orientation: 'portrait',
                    compress: true
                },
                pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
            };

            const button = event.target.closest('button');
            const originalText = button.innerHTML;
            button.innerHTML = '<svg class="w-6 h-6 animate-spin mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>';
            button.disabled = true;

            html2pdf().set(opt).from(element).save().then(() => {
                button.innerHTML = originalText;
                button.disabled = false;
            }).catch(() => {
                button.innerHTML = originalText;
                button.disabled = false;
                alert('Erreur lors de la g√©n√©ration du PDF. Veuillez r√©essayer.');
            });
        }

        // Charger les donn√©es par d√©faut au chargement de la page
        window.addEventListener('DOMContentLoaded', function () {
            // Message d'instruction
            if (!cvData) {
                alert('üëã Bienvenue ! Cliquez sur "IMPORTER UN JSON" pour charger vos donn√©es de CV.');
            }
        });
    </script>

</body>

</html>